package com.nutrien.custmdm.load;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.HashMap;
import java.util.StringTokenizer;

import org.junit.Assert;
import org.junit.Test;

import com.nutrien.custmdm.unit.test.AbstractMDMTest;
import com.nutrien.custmdm.unit.test.CommonUtil;

public class DivisionLoadTest extends AbstractMDMTest {
	
	static String xmlBaseDir = "req/";
	
	@Test
	public void testLoadRegion() throws Exception {
		InputStream fis = DivisionLoadTest.class.getResourceAsStream(xmlBaseDir + "Division.txt");
        BufferedReader br = new BufferedReader(new InputStreamReader(fis));
		
        while (true) {
        	String line = br.readLine();
        	if(line == null)
        		break;
        	
        	StringTokenizer st = new StringTokenizer(line, "|");
        	while (st.hasMoreElements()) {
        		String regionNumber = st.nextToken();
				String number = st.nextToken();
				String name = st.nextToken();
				String status = st.nextToken();
				
				HashMap<String, String> replaceStrings = new HashMap<String, String>();
				replaceStrings.put("status", status);
				replaceStrings.put("name", name);
				replaceStrings.put("number", number);
				replaceStrings.put("regionNumber", regionNumber);
				System.out.println(number);
				String response = sendJSONRequestViaRest(CommonUtil.getTstMsgFromFile(xmlBaseDir, "maintainParty_addDivision.json", replaceStrings, this.getClass()));
		       	
		        Assert.assertEquals(true, response.contains("\"RequestType\":\"MaintainParty\","));
		        Assert.assertEquals(true, response.contains("\"ResultCode\":\"SUCCESS\","));
		        Assert.assertEquals(true, response.contains("\"ResponseObject\":{\"MDMCompositePartyBObj\":"));
        	}
        }
        br.close();
	}
	
	
}
